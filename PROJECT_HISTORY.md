# Desktop Widget 專案功能需求歷程彙整

本文件整理了專案從初始階段至今（2025-12-31）的所有功能需求與開發歷程。

## 初始請求與技術選型 (Inception & Tech Stack)

### 關鍵 User Prompts
以下是用戶在專案初期提出的關鍵原始需求指令：
1.  **"寫一個 desktop widget"**：明確定義專案類型。
2.  **"要透明背景"**：奠定視覺基調（無邊框、玻璃擬態）。
3.  **"加入 CPU/RAM 監控"**：擴充功能至系統工具。
4.  **"左右對齊"**：強調佈局的整潔與對稱性。
5.  **"使用繁體中文"**：指定溝通與設定語言。

### 技術實作分析
在專案啟動時，我們針對不同技術棧進行了評估，最終選擇 **Python (PyQt6)**，原因如下：

| 語言/框架 | 優缺點分析 | 為何選擇 PyQt6？ |
| :--- | :--- | :--- |
| **Python (PyQt/PySide)** | ✅ 開發快、API 串接簡單、系統資源存取直觀。<br>❌ 執行檔稍大。 | **最佳平衡點**：能快速實作天氣 API、系統監控與透明視窗，且開發迭代速度最快。 |
| **JavaScript (Electron)** | ✅ 介面極美、Web 技術通用。<br>❌ 記憶體佔用極高。 | 不適合作為常駐桌面的輕量 Widget，資源消耗過大。 |
| **C# (WinUI 3)** | ✅ 效能好、原生支援。<br>❌ 學習門檻較高。 | 開發週期較長，不如 Python 靈活。 |

---

## 第一階段：基礎氣象小工具 (Basic Widget)
- **基礎功能**：
    - 顯示目前時間（時:分:秒）、星期、日期。
    - 顯示所在城市（預設：桃園 Taoyuan）。
    - 顯示目前天氣狀況（溫度、天氣描述、天氣圖示）。
    - 顯示日出、日落時間與降雨機率。
- **介面風格 (UI)**：
    - 背景全透明或半透明黑底。
    - 圓角視窗設計。
    - 無邊框視窗（Frameless）。
    - 右鍵選單（離開程式）。
- **資料來源**：
    - 使用 `wttr.in` API 抓取天氣資料。

## 第二階段：互動與擴充功能 (Interaction & Expansion)
- **倒數計時器 (Timer)**：
    - 點擊數字時鐘可切換至「倒數計時設定」頁面。
    - 支援輸入 分:秒 (MM:SS)。
    - 倒數結束時，背景呈現紅色閃爍警示。
    - 提供「返回」按鈕切回時鐘模式。
- **待辦事項清單 (To-Do List)**：
    - 新增待辦事項輸入框，按 Enter 新增。
    - 顯示待辦事項列表。
    - 單項刪除功能（× 按鈕）。
    - **資料持久化**：需將代辦事項儲存於 `todo.json`，重開程式不消失。
    - 樣式優化：輸入框字體縮小，列表緊湊化。

## 第三階段：系統監控儀表板 (System Monitor)
- **硬體監控**：
    - **CPU 使用率**：顯示百分比與進度條。
    - **RAM 使用率**：顯示百分比與進度條。
    - 更新頻率：每 5 秒更新一次。
- **網路監控**：
    - **下載速度 (DL)**：顯示即時下載速度（KB/s 或 MB/s）。
    - **上傳速度 (UP)**：顯示即時上傳速度。
    - **視覺化**：加入活動條與動態圖示 (⬇️/⬆️)。
- **磁碟監控**：
    - **C: 槽使用量**：新增 Disk C: 使用率百分比與進度條。

## 第四階段：視覺優化與動態反饋 (Visual Polish)
- **動態顏色系統**：
    - **三段式狀態色**：
        - 正常 (<70%)：CPU 翠綠色 / RAM 金黃色 / Disk 銀灰色。
        - 警告 (70%-90%)：橙色。
        - 危險 (>90%)：鮮紅色。
    - 網路活動條採用專屬色（DL 青藍 / UP 紫色）。
- **介面語言**：
    - 全面英文化 (English UI)。
    - 城市名稱顯示為 TAOYUAN。
- **字體與圖示調整**：
    - 放大數字時鐘字體 (至 48px+)，提升易讀性。
    - 調整溫度字體大小 (56px) 以防截斷。
    - 優化天氣圖示尺寸與間距。

## 第五階段：進階佈局重構 (Layout Refactoring)
- **直列式雙欄佈局**：
    - **左欄 (Left Column)**：
        1. 主氣象卡片 (Main Card)。
        2. 三日預報欄 (Forecast Area)：縮減為 3 天。
        3. 待辦事項卡片 (To-Do Card)。
    - **右欄 (Right Column)**：
        1. 詳細資訊卡片 (Detail Card)：包含大時鐘、日出落、降雨機率。
        2. 系統監控區 (CPU/RAM/Disk/Net)。
- **對齊與間距**：
    - **底端對齊**：精確計算左右兩欄高度 (530px)，確保底部切齊。
    - **頂部對齊**：確保左右兩欄頂部起始點一致。
    - **緊湊化**：大幅壓縮右側資訊欄的行距，消除冗餘留白。
- **功能元件位置移轉**：
    - 將「城市名稱 (Location)」從右側移至左側主卡片。
    - 將預報 (Forecast) 與 To-Do List 整合至左側。

## 第六階段：邏輯與穩定性優化 (Logic functionality)
- **手動重整**：
    - 在主卡片右上角新增 `↻` 按鈕，可手動更新天氣。
- **啟動優化**：
    - **延遲啟動**：程式開啟後等待 2 秒才抓取天氣（避免網路未就緒）。
    - **失敗重試**：若抓取失敗，自動重試最多 2 次。
